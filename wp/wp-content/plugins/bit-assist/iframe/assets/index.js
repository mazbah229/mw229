"use strict";var mt=Object.defineProperty;var lt=Object.getOwnPropertySymbols;var gt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable;var Q=(i,t,e)=>t in i?mt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,E=(i,t)=>{for(var e in t||(t={}))gt.call(t,e)&&Q(i,e,t[e]);if(lt)for(var e of lt(t))ft.call(t,e)&&Q(i,e,t[e]);return i};var h=(i,t,e)=>(Q(i,typeof t!="symbol"?t+"":t,e),e),dt=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var T=(i,t,e)=>(dt(i,t,"read from private field"),e?e.call(i):t.get(i)),U=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},F=(i,t,e,s)=>(dt(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e);var x=(i,t,e)=>new Promise((s,r)=>{var o=d=>{try{c(e.next(d))}catch(p){r(p)}},n=d=>{try{c(e.throw(d))}catch(p){r(p)}},c=d=>d.done?s(d.value):Promise.resolve(d.value).then(o,n);c((e=e.apply(i,t)).next())});const G=""+(typeof document>"u"?new(require("url")).URL("file:"+__dirname+"/close-icon.16a4dff2.svg").href:new URL("close-icon.16a4dff2.svg",document.currentScript&&document.currentScript.tagName.toUpperCase()==="SCRIPT"&&document.currentScript.src||document.baseURI).href),ht=""+(typeof document>"u"?new(require("url")).URL("file:"+__dirname+"/right-circle-arrow.395e19da.svg").href:new URL("right-circle-arrow.395e19da.svg",document.currentScript&&document.currentScript.tagName.toUpperCase()==="SCRIPT"&&document.currentScript.src||document.baseURI).href),u=i=>document.querySelector(i),a=(i,t)=>{const e=document.createElement(i);if(t)for(const s in t)e.setAttribute(s,t[s]);return e},l=(i,t)=>Array.isArray(t)?i.append(...t):i.append(t),y=(i,t,e)=>i.addEventListener(t,e),_=(i,t,e)=>i.setProperty(t,e),H=(i,t,e)=>i.postMessage(t,e),z=(i,t)=>i.querySelectorAll(t),S=(i,t)=>i==null?void 0:i.classList.remove(t),w=(i,t)=>i==null?void 0:i.classList.add(t),A=(i,t)=>i==null?void 0:i.classList.contains(t),q=(i,t)=>i==null?void 0:i.classList.toggle(t),W=(i,t,e)=>{i.setAttribute(t,e)},v=(i,t)=>{i.innerHTML=t},b=(i,t)=>{i.textContent=t},yt={hideChannels(){A(this.channels,"show")&&S(this.channels,"show")},debounce(i,t){let e;return function(...s){const r=this;clearTimeout(e),e=setTimeout(()=>i.apply(r,s),t)}},renderCard(){if(u("#card")){w(this.card,"show");return}this.card=a("div",{id:"card",class:"show"});const i=a("div",{id:"cardHeader"}),t=a("h4"),e=a("button",{class:"iconBtn closeCardBtn",title:"Close"}),s=a("img",{src:G,alt:"Close"});l(e,s),l(i,[t,e]),this.cardBody=a("div",{id:"cardBody"}),l(this.card,[i,this.cardBody]),l(this.contentWrapper,this.card),y(e,"click",this.closeWidget)},setCardStyle(i){var t,e,s,r;this.selectedFormBg=(e=(t=i==null?void 0:i.card_config)==null?void 0:t.card_bg_color)==null?void 0:e.str,v(u("#cardHeader>h4"),i==null?void 0:i.title),_(this.root.style,"--card-theme-color",this.selectedFormBg),_(this.root.style,"--card-text-color",(r=(s=i==null?void 0:i.card_config)==null?void 0:s.card_text_color)==null?void 0:r.str)},hideCard(){A(this.card,"show")&&S(this.card,"show")},itemListAppend(i){const t=[];i==null||i.forEach(e=>{const s=a("div",{class:"listItem"}),r=a("button",{class:"listItemTitleWrapper","data-item_id":e.id?e.id:e.order_id}),o=a("p",{class:"title"});v(o,e.title?e.title:(e.order_id?`Order Id: ${e.order_id} (${e.shipping_status})`:"")||"");const n=a("img",{src:ht,alt:"Details"});l(r,n),l(r,o),l(s,r),t.push(s)}),l(u("#lists"),t)},searchList(i){const t=i.target.value.toLowerCase();z(document,".listItem").forEach(e=>{e.querySelector(".title").textContent.toLowerCase().includes(t)?S(e,"hide"):w(e,"hide")})},resetClientWidgetSize(){H(parent,{action:"resetWidgetSize",height:this.widgetWrapper.offsetHeight,width:this.widgetWrapper.offsetWidth},`${this.clientDomain}`)}},P={renderForm(i){var n;const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const e=(n=i.config)==null?void 0:n.card_config;t.formBody=a("form",{id:"formBody",method:"POST"});const s=a("div",{id:"dynamicFields"}),r=a("input",{type:"hidden",name:"widget_channel_id",value:i.id}),o=a("button",{type:"submit"});b(o,e==null?void 0:e.submit_button_text),l(t.formBody,[s,r,o]),v(t.cardBody,""),l(t.cardBody,t.formBody),y(t.formBody,"submit",c=>P.formSubmitted(t,c)),P.createAllFields(e==null?void 0:e.form_fields)},createAllFields(i){const t=u("#dynamicFields");let e=!1;i==null||i.forEach(s=>{s.field_type==="file"&&!e&&(W(u("#formBody"),"enctype","multipart/form-data"),e=!0),s.field_type==="rating"?P.createRatingField(s,t,"rating"):s.field_type==="feedback"?P.createRatingField(s,t,"feedback"):P.createTextField(s,t)})},createRatingField(i,t,e){const s=Math.floor(Math.random()*1e8),r=i.label.toLowerCase().replace(/ /g,"_"),o=a("div",{class:e});e==="rating"&&w(o,i.rating_type);let n=[];e==="feedback"?n=["bug","suggest","love"]:i.rating_type==="star"?n=["5 star","4 star","3 star","2 star","1 star"]:n=["sad","confused","happy"],n.forEach(c=>{const d=`${r}_${c.replace(/ /g,"_")}_${s}`,p=a("input",{type:"radio",name:r,value:c,id:d});i.required&&W(p,"required","");const m=a("label",{title:c,for:d,class:c});if(e==="feedback"){v(m,`${c.charAt(0).toUpperCase()+c.slice(1)}`);const g=a("div",{class:"feedback-icon"});m.prepend(g)}l(o,[p,m])}),l(t,o)},createTextField(i,t){const e=a(i.field_type==="textarea"?"textarea":"input");if(W(e,"name",`${i.label.toLowerCase().replace(/ /g,"_")}${i!=null&&i.allow_multiple?"[]":""}`),W(e,"placeholder",i.label+(i.required?"":" (optional)")),i.required&&W(e,"required",""),i.field_type==="GDPR"){P.gdprField(i,t,e);return}if(w(e,"formControl"),W(e,"type",i.field_type),i.field_type==="file"){P.fileField(i,t,e);return}l(t,e)},fileField(i,t,e){i!=null&&i.allow_multiple&&W(e,"multiple","");const s=a("div",{class:"formControl customFile"}),r=a("div",{class:"cfit"}),o=a("button",{class:"cfit-btn",type:"button"});b(o,"Attach File");const n=a("div",{class:"cfit-title"});b(n,"No file chosen"),l(r,[o,n]),l(s,[r,e]),l(t,s),y(o,"click",()=>e.click()),y(e,"change",c=>{let d="No file chosen";const p=c.target.files.length;p>0&&(d=p===1?c.target.files[0].name:`${p} files`),b(n,d)})},gdprField(i,t,e){W(e,"type","checkbox");const s=a("a",{target:"_blank"});v(s,i.label),i!=null&&i.url&&(s.href=i.url);const r=a("div",{class:"gdprContainer"});l(r,[e,s]),l(t,r)},formSubmitted(i,t){return x(this,null,function*(){t.preventDefault();const e=t.target.querySelector('[type="submit"]'),s=e.textContent,r=new FormData(t.target);try{b(e,"Sending..."),w(e,"disabled");const o=yield fetch(`${i.apiEndPoint}/responses`,{method:"POST",body:r}).then(n=>n.json());(o==null?void 0:o.status)==="success"?yield P.showToast(i,"success",o==null?void 0:o.data):yield P.showToast(i,"error",o==null?void 0:o.data),t.target.reset(),z(t.target,".cfit-title").forEach(n=>{b(n,"No file chosen")}),S(e,"disabled"),b(e,s)}catch(o){console.log(o),yield P.showToast(i,"error"),t.target.reset(),z(t.target,".cfit-title").forEach(n=>{b(n,"No file chosen")}),S(e,"disabled"),b(e,s)}})},showToast(i,t,e){return x(this,null,function*(){if(!i.cardBody.contains(i.formBody))return;const s=a("div",{class:`toast ${t}`}),r=a("div",{class:"toast-content"}),o=a("div",{class:"toast-text"}),n=a("div",{class:"toast-text-title"});n.textContent=t==="success"?"Success":"Error";const c=a("div",{class:"toast-text-body"});c.textContent=t==="success"?e:"Something went wrong",l(o,[n,c]),l(r,o),l(s,r),l(i.cardBody,s),w(i.formBody,"hide"),A(s,"success")&&(n.style.color=i.selectedFormBg),yield i.delay(2),A(i.formBody,"hide")&&(i.cardBody.removeChild(s),S(i.formBody,"hide"))})}},wt={renderIframe(i,t,e=!1,s=!1){if(this.hideChannels(),this.iFrameWrapper=a("div",{id:"iframe-wrapper",class:t.toLowerCase()}),e)v(this.iFrameWrapper,e);else{const r=a("iframe",{scrolling:(s==null?void 0:s.scrollbar)===!0?"yes":"no",src:i,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""});l(this.iFrameWrapper,r)}if(s){const{aspect_ratio:r,width:o,height:n}=s;r==="custom"&&(_(this.root.style,"--iframe-height",`${o}px`),_(this.root.style,"--iframe-height",`${n}px`)),_(this.root.style,"--iframe-aspect-ratio",r)}l(u("#contentWrapper"),this.iFrameWrapper),this.resetClientWidgetSize()},removeIframe(){this.iFrameWrapper.remove(),this.iFrameWrapper=void 0,this.resetClientWidgetSize()}},tt=""+(typeof document>"u"?new(require("url")).URL("file:"+__dirname+"/left-circle-arrow.39b1d855.svg").href:new URL("left-circle-arrow.39b1d855.svg",document.currentScript&&document.currentScript.tagName.toUpperCase()==="SCRIPT"&&document.currentScript.src||document.baseURI).href),V={renderFaq(i){var B;const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const e=(B=i.config)==null?void 0:B.card_config,s=a("div",{id:"faqBody"}),r=a("div",{id:"listWrapper"}),o=a("div",{id:"lists"}),n=a("input",{type:"text",id:"listSearch",class:"formControl",placeholder:"Search"});l(r,[o,n]);const c=a("div",{id:"faqDescription"}),d=a("div",{class:"descriptionTitle"}),p=a("button",{class:"iconBtn closeDescBtn",title:"Back"}),m=a("img",{src:tt,alt:"back"});l(p,m);const g=a("p");l(d,[p,g]);const f=a("div",{class:"content"});l(c,[d,f]),l(s,[r,c]),v(t.cardBody,""),l(t.cardBody,s),y(n,"input",t.searchList),y(p,"click",C=>V.faqDescToggle(t,C)),V.renderFaqItem(t,e==null?void 0:e.faqs)},renderFaqItem(i,t){i.itemListAppend(t),z(document,".listItemTitleWrapper").forEach(e=>{y(e,"click",s=>V.faqDescToggle(i,s,t))})},faqDescToggle(i,t,e){if(e){const o=e.find(n=>Number(n.id)===Number(t.target.closest(".listItemTitleWrapper").dataset.item_id));v(u(".descriptionTitle p"),(o==null?void 0:o.title)||""),v(u(".content"),(o==null?void 0:o.description)||"")}const s=u("#faqBody");if(q(u("#faqBody"),"openDesc")){const o=u("#faqDescription").scrollHeight;Object.assign(s.style,{height:o>400?"400px":`${o}px`,overflow:o>400?"auto":"initial"})}else s.removeAttribute("style");q(u("#listWrapper"),"hide"),i.resetClientWidgetSize()}},Y={renderKnowledgeBase(i){var R;const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const e=(R=i.config)==null?void 0:R.card_config,s=a("div",{id:"knowledgeBaseBody"}),r=a("div",{id:"listWrapper"}),o=a("div",{id:"lists"}),n=a("input",{type:"text",id:"listSearch",class:"formControl",placeholder:"Search"});l(r,[o,n]);const c=a("div",{class:"overlay"}),d=a("div",{id:"knowledgeBaseDescription"}),p=a("div",{class:"descriptionTitle"}),m=a("p"),g=a("div",{class:"modalActions"}),f=a("button",{class:"iconBtn rounded prevKB",title:"Prev"}),B=a("img",{src:tt,alt:"prev"});l(f,B);const C=a("button",{class:"iconBtn rounded nextKB",title:"Next"}),k=a("img",{src:ht,alt:"next"});l(C,k);const I=a("button",{class:"iconBtn rounded closeKB",title:"Close"}),O=a("img",{src:G,alt:"close"});l(I,O),l(g,[f,C,I]),l(p,[m,g]);const $=a("div",{class:"content"});l(d,[p,$]),l(s,[r,c,d]),v(t.cardBody,""),l(t.cardBody,s),y(n,"input",t.searchList),y(I,"click",()=>Y.knowledgeBaseDescToggle(t)),y(f,"click",()=>t.gotoPrevNextKB("previousElementSibling")),y(C,"click",()=>t.gotoPrevNextKB("nextElementSibling")),t.renderKnowledgeBaseItem(t,e==null?void 0:e.knowledge_bases)},renderKnowledgeBaseItem(i,t){i.itemListAppend(t),z(document,".listItemTitleWrapper").forEach(e=>{y(e,"click",s=>Y.knowledgeBaseDescToggle(i,s,t))})},gotoPrevNextKB(i){const t=u(".listItem.active")[i];t&&t.querySelector(".listItemTitleWrapper").click()},knowledgeBaseDescToggle(i,t,e){S(u(".listItem.active"),"active");const s=u("#knowledgeBaseBody");if(!e){S(s,"openDesc"),_(i.root.style,"--card-width","330px"),i.resetClientWidgetSize();return}q(t.target.closest(".listItem"),"active");const r=e.find(o=>Number(o.id)===Number(t.target.closest(".listItemTitleWrapper").dataset.item_id));!r||(w(s,"openDesc"),v(u(".descriptionTitle p"),(r==null?void 0:r.title)||""),v(u(".content"),(r==null?void 0:r.description)||""),_(i.root.style,"--modal-title-height",`${u(".descriptionTitle").offsetHeight}px`),_(i.root.style,"--card-width","767px"),i.resetClientWidgetSize())}},bt={renderWeChat(i){const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const{url:e}=i.config,s=a("div",{id:"weChatBody",style:"min-height: calc(var(--card-width) - 30px)"}),r=a("img",{id:"weChatQRCode",alt:"WeChat QR Code",src:e,style:"width: 100%"});l(s,r),v(t.cardBody,""),l(t.cardBody,s)}},D={renderWooCommerce(i){var n;const t=this;t.hideChannels(),t.renderCard(),t.setCardStyle(i.config);const e=(n=i.config)==null?void 0:n.card_config;t.formBody=a("form",{id:"formBody",method:"POST"});const s=a("div",{id:"dynamicFields"}),r=a("input",{type:"hidden",name:"widget_channel_id",value:i.id}),o=a("button",{type:"submit"});b(o,e==null?void 0:e.submit_button_text),l(t.formBody,[s,r,o]),v(t.cardBody,""),l(t.cardBody,t.formBody),y(t.formBody,"submit",c=>D.formSubmitted(t,c,i)),D.createAllFields(e==null?void 0:e.form_fields)},createAllFields(i){const t=u("#dynamicFields");i==null||i.forEach(e=>{D.createTextField(e,t)})},createTextField(i,t){const e=a("input"),s=i.field_type,r=s.includes("_")?s.split("_")[1]:s;W(e,"name",`${r}`),W(e,"placeholder",i.label+(i.required?"":" (optional)")),i.required&&W(e,"required",""),w(e,"formControl"),W(e,"type",s),l(t,e)},formSubmitted(i,t,e){return x(this,null,function*(){t.preventDefault();const s=t.target.querySelector('[type="submit"]'),r=s.textContent,o=new FormData(t.target);try{b(s,"Sending..."),w(s,"disabled");const n=yield fetch(`${i.apiEndPoint}/responses`,{method:"POST",body:o}).then(c=>c.json());(n==null?void 0:n.status)==="success"?D.formSubmittedData(i,o,e):yield D.showToast(i,"error",n==null?void 0:n.data,e),t.target.reset(),z(t.target,".cfit-title").forEach(c=>{b(c,"No file chosen")}),S(s,"disabled"),b(s,r)}catch(n){console.log(n),yield D.showToast(i,"error"),S(s,"disabled"),b(s,r)}})},formSubmittedData(i,t,e,s=1){return x(this,null,function*(){t.set("page",s);const r=yield fetch(`${i.apiEndPoint}/orderDetails`,{method:"POST",body:t}).then(o=>o.json());r.status==="success"&&(yield D.showToast(i,"success",r==null?void 0:r.data,e,t))})},showToast(i,t,e,s,r){return x(this,null,function*(){var m,g;if((e==null?void 0:e.status_code)===200){D.orderDetailsItems(i,e,s),(((m=e==null?void 0:e.pagination)==null?void 0:m.has_next)||((g=e==null?void 0:e.pagination)==null?void 0:g.has_previous))&&D.renderOrderDetailsPagination(i,e==null?void 0:e.pagination,r,s);return}const o=a("div",{class:`toast ${t}`}),n=a("div",{class:"toast-content"}),c=a("div",{class:"toast-text"}),d=a("div",{class:"toast-text-title"});d.textContent=t==="success"?"404":"Error";const p=a("div",{class:"toast-text-body"});p.textContent=t==="success"?e==null?void 0:e.message:"Something went wrong",l(c,[d,p]),l(n,c),l(o,n),l(i.cardBody,o),w(i.formBody,"hide"),A(o,"success")&&(d.style.color=i.selectedFormBg),yield i.delay(2),A(i.formBody,"hide")&&(i.cardBody.removeChild(o),S(i.formBody,"hide"))})},orderDetailsItems(i,t,e){var f;const s=a("div",{id:"orderDetailsBody"}),r=a("div",{id:"listWrapper"}),o=a("div",{id:"lists"});l(r,o);const n=a("div",{id:"orderDetailsDescription"}),c=a("div",{class:"descriptionTitle"}),d=a("button",{class:"iconBtn closeDescBtn",title:"Back"});v(d,tt);const p=a("p");l(c,[d,p]);const m=a("div",{class:"content"});l(n,[c,m]),l(s,[r,n]),v(i.cardBody,""),l(i.cardBody,s);const g=(f=e==null?void 0:e.config)==null?void 0:f.order_details;if(t.items.length===1){D.singleItemContentShow(i,g,t);return}y(d,"click",B=>D.orderDetailsDescToggle(i,B)),D.renderWooCommerceItem(i,t,g)},singleItemContentShow(i,t,e){const s=e.items[0],r=u("#orderDetailsBody");r.removeChild(u("#listWrapper")),r.removeChild(u("#orderDetailsDescription"));const o=a("div",{id:"singleItemContent"}),n=a("p",{class:"descriptionTitle title"});v(n,s.order_id?`Order Id: ${s.order_id} (${s.shipping_status})`:"");const c=a("div",{class:"content"});l(o,[n,c]),l(r,o),D.showContent(t,s),i.resetClientWidgetSize()},renderWooCommerceItem(i,t,e){i.itemListAppend(t.items),z(document,".listItemTitleWrapper").forEach(s=>{y(s,"click",r=>{D.orderDetailsDescToggle(i,r,t,e)})}),i.resetClientWidgetSize()},orderDetailsDescToggle(i,t,e,s){if(e){const n=e.items.find(c=>Number(c.order_id)===Number(t.target.closest(".listItemTitleWrapper").dataset.item_id));v(u(".descriptionTitle p"),`Order Id: ${n==null?void 0:n.order_id}`||""),D.showContent(s,n)}const r=u("#orderDetailsBody");if(q(u("#orderDetailsBody"),"openDesc")){const n=u("#orderDetailsDescription").scrollHeight;Object.assign(r.style,{height:n>400?"400px":`${n}px`,overflow:n>400?"auto":"initial"})}else r.removeAttribute("style");q(u("#listWrapper"),"hide"),i.resetClientWidgetSize()},showContent(i,t){let e="";i==null||i.filter(Boolean).forEach(s=>{const r=s.split("_").map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" ");let o=t[s];typeof o=="string"&&(o=o.split("-").map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" ")),e+=`${r}: ${o}<br>`}),v(u(".content"),e),u(".content").style.fontSize="1rem",u(".content").style.lineHeight="2"},renderOrderDetailsPagination(i,t,e,s){const r=a("div",{class:"pagination"}),o=a("span",{class:"pageNumber"});b(o,`${t==null?void 0:t.current} / ${t==null?void 0:t.total} page`);const n=a("button",{class:"nextPage"});b(n,"Next"),t!=null&&t.has_next||W(n,"disabled","");const c=a("button",{class:"prevPage"});b(c,"Prev"),t!=null&&t.has_previous||W(c,"disabled",""),y(n,"click",()=>D.formSubmittedData(i,e,s,t==null?void 0:t.next)),y(c,"click",()=>D.formSubmittedData(i,e,s,t==null?void 0:t.previous)),l(r,[c,n,o]),l(u("#lists"),r),i.resetClientWidgetSize()}},Z={wp_post_types:void 0,renderWPSearch(i){this.hideChannels(),this.renderCard(),this.setCardStyle(i),Z.wp_post_types=i==null?void 0:i.wp_post_types;const t=a("div",{id:"wpSearchBody"}),e=a("div",{id:"listWrapper"}),s=a("div",{id:"lists","data-link_open_action":i.open_window_action}),r=a("input",{type:"text",id:"listSearch",class:"formControl",placeholder:"Search"});l(e,[s,r]),l(t,e),v(this.cardBody,""),l(this.cardBody,t),this.searchPostPage(""),y(r,"input",this.debounce(o=>this.searchPostPage(o.target.value),600))},searchPostPage(i,t=1){return x(this,null,function*(){const{data:e,pagination:s}=yield this.fetchWPSearchData(i,t);this.renderWPSearchItem(e),((s==null?void 0:s.has_next)||(s==null?void 0:s.has_previous))&&this.renderWPSearchPagination(s),this.resetClientWidgetSize()})},fetchWPSearchData(i,t){return x(this,null,function*(){const{data:e}=yield fetch(`${this.apiEndPoint}/wpSearch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search:i,page:t,postTypes:Z.wp_post_types})}).then(s=>s.json());return e})},renderWPSearchItem(i){const t=u("#lists");v(t,"");const e=[];i==null||i.forEach(s=>{const r=a("div",{class:"listItem"}),o=a("button",{class:"listItemTitleWrapper",title:s.guid}),n=a("p",{class:"title"}),c=a("p",{class:"type"});l(r,o),l(o,[n,c]),b(n,(s==null?void 0:s.post_title)||"(no title)"),b(c,(s==null?void 0:s.post_type)||""),e.push(r),y(o,"click",()=>{const{link_open_action:d}=t.dataset;d==="new_window"?window.open(s.guid,"_blank","popup"):window.open(s.guid,d)})}),l(t,e)},renderWPSearchPagination(i){var n;const t=a("div",{class:"pagination"}),e=a("span",{class:"pageNumber"});b(e,`${i==null?void 0:i.current} / ${i==null?void 0:i.total} page`);const s=a("button",{class:"nextPage"});b(s,"Next"),i!=null&&i.has_next||W(s,"disabled","");const r=a("button",{class:"prevPage"});b(r,"Prev"),i!=null&&i.has_previous||W(r,"disabled","");const o=((n=u("#listSearch"))==null?void 0:n.value)||"";y(s,"click",()=>this.searchPostPage(o,i==null?void 0:i.next)),y(r,"click",()=>this.searchPostPage(o,i==null?void 0:i.previous)),l(t,[r,s,e]),l(u("#lists"),t)}};var N,L,M,j,J;class pt{constructor(t){h(this,"apiEndPoint");h(this,"root");h(this,"widgetData");h(this,"clientDomain");h(this,"widgetBubble");h(this,"widgetBubbleWrapper");h(this,"contentWrapper");h(this,"widgetWrapper");h(this,"channels");U(this,N,void 0);U(this,L,void 0);U(this,M,void 0);h(this,"callToAction");h(this,"closeCallToAction");U(this,j,void 0);h(this,"card");h(this,"selectedFormBg");h(this,"cardBody");h(this,"formBody");U(this,J,void 0);h(this,"iFrameWrapper");h(this,"animationName");h(this,"formData");h(this,"clickTrack");h(this,"delay",t=>new Promise(e=>setTimeout(e,t*1e3)));h(this,"addEvents",()=>{y(window,"message",this.onMessageReceived),y(this.widgetBubble,"click",this.onBubbleClick)});h(this,"closeWidget",()=>{this.hideCard(),this.hideChannels(),typeof this.iFrameWrapper<"u"&&this.removeIframe(),S(this.widgetBubble,"open"),w(this.contentWrapper,"hide"),this.widgetOpenActions(!1),_(this.root.style,"--card-width","330px"),this.showActiveBadge(),this.enableAnimation()});h(this,"widgetClickRequest",()=>x(this,null,function*(){if(A(this.channels,"show")&&!this.clickTrack.isWidgetClicked){this.clickTrack.isWidgetClicked=!0;try{fetch(`${this.apiEndPoint}/analyticsStore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({widget_id:this.widgetData.id,is_clicked:1})})}catch(t){console.log(t)}}}));h(this,"onBubbleClick",(t,e=!1)=>{var s,r,o;if(!(e&&A(this.widgetBubble,"open"))){if(((r=(s=this.widgetData)==null?void 0:s.styles)==null?void 0:r.widget_style)==="widget_box"&&w(this.contentWrapper,"widget-box"),q(this.channels,"show"),((o=this.widgetData)==null?void 0:o.isAnalyticsActivate)===1&&this.widgetClickRequest(),A(this.card,"show"))_(this.root.style,"--card-width","330px"),this.hideCard(),this.resetClientWidgetSize();else if(typeof this.iFrameWrapper<"u")this.removeIframe();else{q(this.contentWrapper,"hide");const n=q(this.widgetBubble,"open");this.widgetOpenActions(n)}A(this.contentWrapper,"hide")?(this.showActiveBadge(),this.enableAnimation()):(this.hideActiveBadge(),this.disableAnimation())}});h(this,"widgetOpenActions",t=>{if(this.openClientWidget(t),t&&!A(this.callToAction,"hide")){this.callToActionHide();return}this.resetClientWidgetSize()});h(this,"callToActionHide",()=>{w(this.callToAction,"hide"),w(this.closeCallToAction,"hide"),this.resetClientWidgetSize()});h(this,"channelClickRequest",t=>x(this,null,function*(){if(t!==void 0&&!Object.hasOwn(this.clickTrack,t)){this.clickTrack[t]=!0;try{fetch(`${this.apiEndPoint}/analyticsStore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({widget_id:this.widgetData.id,channel_id:t,is_clicked:1})})}catch(e){console.log(e)}}}));h(this,"onChannelClick",t=>{var g,f,B,C,k,I,O,$;t.preventDefault();let e=t.target.closest(".channel");((f=(g=this.widgetData)==null?void 0:g.styles)==null?void 0:f.widget_style)==="widget_box"&&(e=t.target.closest(".channel-widget-box"));const{id:s,url:r,channel_name:o,target:n}=e.dataset||{},c=(B=this.widgetData)==null?void 0:B.widget_channels.find(R=>R.id===s),{title:d,unique_id:p}=(c==null?void 0:c.config)||{},{isChatWidget:m}=((C=c==null?void 0:c.config)==null?void 0:C.card_config)||{};((k=this.widgetData)==null?void 0:k.isAnalyticsActivate)===1&&this.channelClickRequest(s),o==="faq"?this.renderFaq(c):o==="wechat"?this.renderWeChat(c):o==="custom-form"?this.renderForm(c):o==="woocommerce"?this.renderWooCommerce(c):o==="knowledge-base"?this.renderKnowledgeBase(c):o==="wp-search"?this.renderWPSearch(c==null?void 0:c.config):o==="google-map"?this.renderIframe(r,o,p):o==="youtube"||o==="custom-iframe"?this.renderIframe(r,o,!1,(I=c==null?void 0:c.config)==null?void 0:I.iframe_options):m?this.chatWidgetClick(o):n==="new_window"&&r!=="#"?window.open(r,"_blank","popup"):r!=="#"&&window.open(r,n),this.resetClientWidgetSize(),(($=(O=this.widgetData)==null?void 0:O.styles)==null?void 0:$.google_analytics)===1&&this.channelClickEventTrigger(o,d,r)});h(this,"getClientInfo",()=>{H(parent,{action:"getClientInfo"},`${this.clientDomain}`)});h(this,"openClientWidget",t=>{H(parent,{action:"widgetOpen",isWidgetOpen:t},`${this.clientDomain}`)});h(this,"removeClientWidget",()=>{H(parent,{action:"removeWidget"},`${this.clientDomain}`)});h(this,"renderWidgetConf",()=>{var t,e,s,r,o,n,c,d,p,m,g,f,B,C,k;H(parent,{action:"widgetLoaded",height:(((e=(t=this.widgetData)==null?void 0:t.styles)==null?void 0:e.size)||60)+20,width:(((r=(s=this.widgetData)==null?void 0:s.styles)==null?void 0:r.size)||60)+20,position:(n=(o=this.widgetData)==null?void 0:o.styles)==null?void 0:n.position,top:((d=(c=this.widgetData)==null?void 0:c.styles)==null?void 0:d.top)||0,bottom:((m=(p=this.widgetData)==null?void 0:p.styles)==null?void 0:m.bottom)||0,left:((f=(g=this.widgetData)==null?void 0:g.styles)==null?void 0:f.left)||0,right:((C=(B=this.widgetData)==null?void 0:B.styles)==null?void 0:C.right)||0,pageScroll:(k=this.widgetData)==null?void 0:k.page_scroll},`${this.clientDomain}`)});h(this,"chatWidgetClick",t=>{H(parent,{action:"chatWidgetClick",chatWidgetName:t},`${this.clientDomain}`)});h(this,"channelClickEventTrigger",(t,e,s)=>{H(parent,{action:"bitAssistChannelClick",channelInfo:{channelType:t,channelName:e,channelUrl:s}},`${this.clientDomain}`)});h(this,"onMessageReceived",t=>{const{action:e}=t.data;e==="windowLoaded"?this.handleWindowLoaded(t.data):e==="scrollPercent"?this.handleScrollPercent(t.data):e==="clickOutside"&&this.closeWidget()});h(this,"handleWindowLoaded",({url:t,winWidth:e,winHeight:s,scrollPercent:r,apiEndPoint:o})=>{_(this.root.style,"--client-win-width",`${e}px`),_(this.root.style,"--client-win-height",`${s}px`),F(this,M,r),this.apiEndPoint=o,F(this,N,e<768),F(this,L,t.slice(this.clientDomain.length+1,t.length)),this.fetchWidgetData()});h(this,"handleScrollPercent",({scrollPercent:t})=>{var e;F(this,M,t),((e=this.widgetData)==null?void 0:e.page_scroll)>0&&!T(this,J)&&this.widgetShowAfterScroll()});h(this,"fetchWidgetData",()=>x(this,null,function*(){try{const{data:t}=yield fetch(`${this.apiEndPoint}/bitAssistWidget`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:this.clientDomain})}).then(e=>e.json());if(this.widgetData=t,typeof this.widgetData.id>"u"){console.error(this.widgetData),this.removeClientWidget();return}this.widgetSetup()}catch(t){console.log(t),this.removeClientWidget()}}));h(this,"widgetSetup",()=>x(this,null,function*(){var e,s,r,o,n,c,d,p,m,g,f,B,C,k,I,O,$;const t=(s=(e=this.widgetData)==null?void 0:e.styles)==null?void 0:s.widget_show_on;t!==void 0&&(t.length===0||T(this,N)&&!t.includes("mobile")||!T(this,N)&&!t.includes("desktop"))||!this.setWidgetVisibleOrNot()||(this.renderWidgetConf(),!(((o=(r=this.widgetData)==null?void 0:r.business_hours)==null?void 0:o.length)&&!this.checkBusinessHours())&&(this.addCustomStyles(),this.renderChannels(),this.renderWidgetBubble(),this.hideCredit(),F(this,J,!0),yield this.widgetShowDelay(),this.delayExist=!1,this.showCallToAction(),this.widgetShowAfterScroll(),((c=(n=this.widgetData.styles)==null?void 0:n.position)==null?void 0:c.indexOf("top"))>-1&&_(this.root.style,"--widget-minus-sizeY",`${((d=this.widgetData.styles)==null?void 0:d.top)||0}px`),((m=(p=this.widgetData.styles)==null?void 0:p.position)==null?void 0:m.indexOf("bottom"))>-1&&_(this.root.style,"--widget-minus-sizeY",`${((g=this.widgetData.styles)==null?void 0:g.bottom)||0}px`),((B=(f=this.widgetData.styles)==null?void 0:f.position)==null?void 0:B.indexOf("left"))>-1&&_(this.root.style,"--widget-minus-sizeX",`${((C=this.widgetData.styles)==null?void 0:C.left)||0}px`),((I=(k=this.widgetData.styles)==null?void 0:k.position)==null?void 0:I.indexOf("right"))>-1&&_(this.root.style,"--widget-minus-sizeX",`${((O=this.widgetData.styles)==null?void 0:O.right)||0}px`),(($=this.widgetData)==null?void 0:$.isAnalyticsActivate)&&this.widgetData.id!=="undefined"&&this.widgetData.widget_channels.length!==0&&fetch(`${this.apiEndPoint}/analyticsStore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({widget_id:this.widgetData.id})})))}));h(this,"hideCredit",()=>{var t,e;(t=this.widgetData)!=null&&t.hide_credit&&((e=u("#credit"))==null||e.remove())});h(this,"setWidgetVisibleOrNot",()=>{var t,e,s;if(((e=(t=this.widgetData)==null?void 0:t.exclude_pages)==null?void 0:e.length)>0){let r=!1,o=!1;const n=(s=this.widgetData)==null?void 0:s.exclude_pages.some(c=>(c.visibility==="showOn"&&(r=!0),c.condition==="contains"&&T(this,L).includes(c.url)||c.condition==="equal"&&T(this,L)===c.url||c.condition==="startWith"&&T(this,L).startsWith(c.url)||c.condition==="endWith"&&T(this,L).endsWith(c.url)?c.visibility==="hideOn"?!0:(o=!0,!1):!1));if(r&&!n&&!o||!r&&n&&!o)return this.removeClientWidget(),!1}return!0});h(this,"checkBusinessHours",()=>{var g,f;const t=new Date,e=(g=this.widgetData)==null?void 0:g.business_hours[t.getDay()];if(!e||!(e!=null&&e.start)||!(e!=null&&e.end))return this.removeClientWidget(),!1;const[s,r]=(e==null?void 0:e.start.split(":").map(Number))||[0,0],[o,n]=(e==null?void 0:e.end.split(":").map(Number))||[0,0],c=((f=this.widgetData)==null?void 0:f.timezone)||Intl.DateTimeFormat().resolvedOptions().timeZone,d=t.toLocaleTimeString("en-US",{timeZone:c,hour12:!1}),[p,m]=d.split(":").map(Number);return(p<s||p===s&&m<r||p>o||p===o&&m>n)&&F(this,j,!1),!0});h(this,"addCustomStyles",()=>{var t;if(((t=this.widgetData.custom_css)==null?void 0:t.length)>0){const e=a("style");l(e,document.createTextNode(this.widgetData.custom_css)),l(document.head,e)}});h(this,"renderChannels",()=>{var s,r,o,n;const t=(r=(s=this.widgetData)==null?void 0:s.styles)==null?void 0:r.widget_style;this.channels=a("div",{id:"channels"}),t==="widget_box"&&w(this.channels,"channel-padding");const e=(n=(o=this.widgetData)==null?void 0:o.widget_channels)==null?void 0:n.filter(c=>{var d,p,m;return(T(this,N)&&((d=c.config)==null?void 0:d.channel_show_on.includes("mobile"))||!T(this,N)&&((p=c.config)==null?void 0:p.channel_show_on.includes("desktop")))&&(!T(this,j)&&!((m=c.config)!=null&&m.hide_after_office_hours)||T(this,j))}).map(c=>{var f;const d=a("button",{class:t==="widget_box"?"channel-widget-box":"channel","data-id":c.id,"data-channel_name":c.channel_name.toLowerCase(),"data-url":((f=c.config)==null?void 0:f.url)||"#","data-target":c.config.open_window_action}),p=a("div",{class:"channel-name"});b(p,c.config.title);const m=a("div",{class:"channel-icon"}),g=a("img",{src:c.channel_icon,alt:c.config.title});return l(m,g),l(d,[p,m]),d});l(this.channels,e),l(this.contentWrapper,this.channels),t==="widget_box"&&w(this.contentWrapper,"widget-box"),z(document,t==="widget_box"?".channel-widget-box":".channel").forEach(c=>{y(c,"click",this.onChannelClick)})});h(this,"renderWidgetBubble",()=>{var e,s,r,o,n,c,d,p,m,g,f,B,C,k,I,O,$,R,et,it,st,ot,rt,nt,ct,at;_(this.root.style,"--widget-size",`${((s=(e=this.widgetData)==null?void 0:e.styles)==null?void 0:s.size)||60}px`),_(this.root.style,"--widget-color",(n=(o=(r=this.widgetData)==null?void 0:r.styles)==null?void 0:o.color)==null?void 0:n.str),((c=this.widgetData)==null?void 0:c.widget_behavior)===2?y(this.widgetBubble,"mouseenter",ut=>this.onBubbleClick(ut,!0)):((d=this.widgetData)==null?void 0:d.widget_behavior)===3&&this.onBubbleClick(),w(this.widgetBubble,(m=(p=this.widgetData)==null?void 0:p.styles)==null?void 0:m.shape),w(this.widgetWrapper,(f=(g=this.widgetData)==null?void 0:g.styles)==null?void 0:f.position),u("#widget-img").src=((C=(B=this.widgetData)==null?void 0:B.styles)==null?void 0:C.customImage)||((I=(k=this.widgetData)==null?void 0:k.styles)==null?void 0:I.iconUrl),w(u("#widget-img"),($=(O=this.widgetData)==null?void 0:O.styles)!=null&&$.customImage?"image":"icon");const t=Math.round((Number.parseInt((it=(et=(R=this.widgetData)==null?void 0:R.styles)==null?void 0:et.color)==null?void 0:it.r,10)*299+Number.parseInt((rt=(ot=(st=this.widgetData)==null?void 0:st.styles)==null?void 0:ot.color)==null?void 0:rt.g,10)*587+Number.parseInt((at=(ct=(nt=this.widgetData)==null?void 0:nt.styles)==null?void 0:ct.color)==null?void 0:at.b,10)*114)/1e3);_(this.root.style,"--widget-bubble-icon-color",t>125?"invert(0)":"invert(1)"),this.showActiveBadge(),this.enableAnimation(),A(this.channels,"show")&&(this.hideActiveBadge(),this.disableAnimation())});h(this,"showActiveBadge",()=>{var e,s,r,o,n,c,d;const t=(s=(e=this.widgetData)==null?void 0:e.styles)==null?void 0:s.shape;((o=(r=this.widgetData)==null?void 0:r.styles)==null?void 0:o.badge_active)===0?S(this.widgetBubbleWrapper,`active-${t}`):(w(this.widgetBubbleWrapper,`active-${t}`),_(this.root.style,"--widget-active-badge-color",(d=(c=(n=this.widgetData)==null?void 0:n.styles)==null?void 0:c.badge_color)==null?void 0:d.str)),this.resetClientWidgetSize()});h(this,"hideActiveBadge",()=>{var t,e;S(this.widgetBubbleWrapper,`active-${(e=(t=this.widgetData)==null?void 0:t.styles)==null?void 0:e.shape}`)});h(this,"enableAnimation",()=>{var e,s,r,o,n,c,d;const t=(s=(e=this.widgetData)==null?void 0:e.styles)==null?void 0:s.animation_type;((o=(r=this.widgetData)==null?void 0:r.styles)==null?void 0:o.animation_active)===1&&(_(this.root.style,"--animation-delay",`${(d=(c=(n=this.widgetData)==null?void 0:n.styles)==null?void 0:c.animation_delay)==null?void 0:d.delay}s`),t===1?(this.animationName="--wiggle-animation",w(this.widgetBubbleWrapper,this.animationName)):t===2?(this.animationName="--jump-animation",w(this.widgetBubbleWrapper,this.animationName)):t===3&&(this.animationName="--shockwave-animation",w(this.widgetBubbleWrapper,this.animationName))),this.resetClientWidgetSize()});h(this,"disableAnimation",()=>{S(this.widgetBubbleWrapper,this.animationName)});h(this,"widgetShowDelay",()=>x(this,null,function*(){var t;((t=this.widgetData)==null?void 0:t.initial_delay)>0&&(yield this.delay(this.widgetData.initial_delay))}));h(this,"widgetShowAfterScroll",()=>x(this,null,function*(){var t,e;((t=this.widgetData)==null?void 0:t.page_scroll)<=0||T(this,M)>=((e=this.widgetData)==null?void 0:e.page_scroll)?S(this.widgetWrapper,"hide"):w(this.widgetWrapper,"hide"),this.resetClientWidgetSize()}));h(this,"showCallToAction",()=>x(this,null,function*(){var e,s,r,o;if(!((s=(e=this.widgetData)==null?void 0:e.call_to_action)!=null&&s.text))return;((o=(r=this.widgetData)==null?void 0:r.call_to_action)==null?void 0:o.delay)>0&&(yield this.delay(this.widgetData.call_to_action.delay)),this.callToAction=a("div",{id:"callToActionMsg"}),v(this.callToAction,this.widgetData.call_to_action.text);const t=a("img",{src:G});if(this.closeCallToAction=a("button",{class:"iconBtn",id:"closeCallToAction"}),l(this.closeCallToAction,t),y(this.closeCallToAction,"click",this.callToActionHide),u("#widgetBubbleRow").prepend(this.closeCallToAction,this.callToAction),A(this.widgetBubble,"open")){this.callToActionHide();return}this.resetClientWidgetSize()}));this.clickTrack={isWidgetClicked:!1},F(this,J,!0),F(this,j,!0),F(this,N,!1),this.root=document.documentElement,this.clientDomain=t.clientDomain,this.contentWrapper=u("#contentWrapper"),this.widgetWrapper=u("#widgetWrapper"),this.widgetBubbleWrapper=u("#widgetBubbleWrapper"),this.widgetBubble=u("#widgetBubble"),this.addEvents(),this.getClientInfo()}}N=new WeakMap,L=new WeakMap,M=new WeakMap,j=new WeakMap,J=new WeakMap;Object.assign(pt.prototype,E(E(E(E(E(E(E(E({},P),yt),wt),V),Y),bt),D),Z));const vt=new URL(window.location.href),X=vt.searchParams.get("clientDomain"),K=X==null?void 0:X.split("-protocol-bit-assist-"),_t=(K==null?void 0:K[0])==="i"?"http://":"https://",Bt=K==null?void 0:K[1],Dt=_t+Bt;window.addEventListener("load",()=>{new pt({clientDomain:Dt})});
